<!doctype html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.8.0/font/bootstrap-icons.css">

    <script src="https://unpkg.com/vue@3/dist/vue.global.js"></script>

    <style>
        .button {
            width: 100px;
            height: 100px;
            margin: 5px;
            opacity: 1;
            color: white;
            /* background-color: wheat !important; */
        }

        .button-sm {
            width: 50px;
            height: 50px;
            margin: 5px;
            opacity: 1;
            color: white;
        }

        .input-display {
            color: white;
            opacity: 1 !important;
            font-size: 4rem;
        }

        .flex-break {
            flex: 0 0 100% !important;
        }
    </style>

    <title>Index</title>
</head>

<body>
    <div id="app" class="container py-5">
        <div class="card mt-3">
            <div class="card-body">
                <h1 class="card-title">Customize Visualization</h1>
                <hr />
                <div class="d-flex flex-wrap justify-content-center p-5">
                    <div id="controller" class="d-flex flex-shrink p-5 rounded-pill">
                        <div id="directions" class="flex-column justify-content-center align-items-center"
                            style="width: 256px; height: 256px;" style="display: flex;" for-levered>
                            <div id="stick" class="button rounded-circle"></div>
                        </div>
                        <div class="flex-column justify-content-center" style="display: flex;" for-hitbox>
                            <div class="d-flex flex-row">
                                <div id="hLeft" class="button rounded-circle input-display"></div>
                                <div id="hDown" class="button rounded-circle input-display"></div>
                                <div id="hRight" class="button rounded-circle input-display me-5"></div>
                            </div>
                            <div class="d-flex flex-row justify-content-end">
                                <div id="hUp" class="button rounded-circle input-display"></div>
                            </div>
                        </div>
                        <div class="flex-column justify-content-center" style="display: flex;" for-mixbox>
                            <div class="d-flex flex-row justify-content-center">
                                <div id="mUp" class="button-sm input-display"></div>
                            </div>
                            <div class="d-flex flex-row">
                                <div id="mLeft" class="button-sm input-display"></div>
                                <div id="mDown" class="button-sm input-display"></div>
                                <div id="mRight" class="button-sm input-display"></div>
                            </div>
                        </div>
                        <div id="buttons" class="d-flex flex-column justify-content-center ms-5">
                            <div class="d-flex flex-row">
                                <div id="t1" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>T1</p>
                                </div>
                                <div id="t2" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>T2</p>
                                </div>
                                <div id="t3" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>T3</p>
                                </div>
                                <div id="t4" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>T4</p>
                                </div>
                            </div>
                            <div class="d-flex flex-row">
                                <div id="b1" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>B1</p>
                                </div>
                                <div id="b2" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>B2</p>
                                </div>
                                <div id="b3" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>B3</p>
                                </div>
                                <div id="b4" class="button rounded-circle input-display d-flex justify-content-center">
                                    <p>B4</p>
                                </div>
                            </div>
                        </div>
                    </div>
                    <div class="flex-break"></div>
                    <div id="inputHistory" class="flex-grow rounded-pill mt-3" style="display: flex;">
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-down"></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-down-right"></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-right"></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-down"></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-down-right"></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i
                                class="bi bi-arrow-right"></i>
                        </div>
                        <div id="t1" class="button rounded-circle input-display d-flex justify-content-center">
                            <p>T1</p>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i class=""></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i class=""></i>
                        </div>
                        <div class="button rounded-circle input-display d-flex justify-content-center"><i class=""></i>
                        </div>
                    </div>
                </div>

                <h2>Parameters</h2>
                <hr />

                <h3>General</h3>
                <label for="inputType" class="form-label">Input Style</label>
                <select id="inputType" class="form-select mb-3" oninput="changeType(this.value)">
                    <option>Arcade</option>
                    <option>Hitbox</option>
                    <option>Mixbox</option>
                </select>

                <div class="row gy-3">
                    <div class="col-12 col-md-6">
                        <color-picker id="controllerColor" red="33" green="37" blue="41" alpha="1" element="controller">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Controller Background Color</h5>
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="historyColor" red="33" green="37" blue="41" alpha="1" element="inputHistory">
                            <div class="card-body d-flex flex-row align-items-center justify-content-between"
                                slot="body">
                                <h5 class="card-text m-0">History Background Color</h5>
                                <div class="form-check">
                                    <input type="checkbox" id="showHistory" class="form-check-input" checked
                                        oninput="byId('inputHistory').style.display = (event.currentTarget.checked) ? 'flex' : 'none'">
                                    <label class="form-check-label" for="showHistory">Show Input History?</label>
                                </div>
                            </div>
                        </color-picker>
                    </div>
                </div>

                <h3 class="mt-3">Movement</h3>
                <div class="row gy-3" for-levered>
                    <div class="col">
                        <color-picker id="stickColor" red="107" green="7" blue="0" alpha="1" element="stick">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Stick Color</h5>
                            </div>
                        </color-picker>
                    </div>
                </div>
                <div class="row gy-3" for-leverless>
                    <div class="col-12 col-md-6">
                        <color-picker id="upColor" red="52" green="58" blue="64" alpha="1" element="hUp">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Up Color</h5>
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="downColor" red="52" green="58" blue="64" alpha="1" element="hDown">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Down Color</h5>
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="leftColor" red="52" green="58" blue="64" alpha="1" element="hLeft">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Left Color</h5>
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="rightColor" red="52" green="58" blue="64" alpha="1" element="hRight">
                            <div class="card-body" slot="body">
                                <h5 class="card-text">Right Color</h5>
                            </div>
                        </color-picker>
                    </div>
                </div>

                <h3 class="mt-3">Actions</h3>
                <h5>Top Row</h5>
                <div class="row gy-3">
                    <div class="col-12 col-md-6">
                        <color-picker id="t1Color" red="52" green="58" blue="64" alpha="1" element="t1">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">T1 Color</h5>
                                <input type="text" id="t1Text" class="form-control"
                                    placeholder="T1 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="t2Color" red="52" green="58" blue="64" alpha="1" element="t2">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">T2 Color</h5>
                                <input type="text" id="t2Text" class="form-control"
                                    placeholder="T2 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="t3Color" red="52" green="58" blue="64" alpha="1" element="t3">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">T3 Color</h5>
                                <input type="text" id="t3Text" class="form-control"
                                    placeholder="T3 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="t4Color" red="52" green="58" blue="64" alpha="1" element="t4">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">T4 Color</h5>
                                <input type="text" id="t4Text" class="form-control"
                                    placeholder="T4 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                </div>

                <h5 class="mt-2">Bottom Row</h5>
                <div class="row gy-3">
                    <div class="col-12 col-md-6">
                        <color-picker id="b1Color" red="52" green="58" blue="64" alpha="1" element="b1">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">B1 Color</h5>
                                <input type="text" id="b1Text" class="form-control"
                                    placeholder="B1 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="b2Color" red="52" green="58" blue="64" alpha="1" element="b2">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">B2 Color</h5>
                                <input type="text" id="b2Text" class="form-control"
                                    placeholder="B2 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="b3Color" red="52" green="58" blue="64" alpha="1" element="b3">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">B3 Color</h5>
                                <input type="text" id="b3Text" class="form-control"
                                    placeholder="B3 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                    <div class="col-12 col-md-6">
                        <color-picker id="b4Color" red="52" green="58" blue="64" alpha="1" element="b4">
                            <div class="card-body d-flex flex-row align-items-center" slot="body">
                                <h5 class="card-text w-25 m-0">B4 Color</h5>
                                <input type="text" id="b4Text" class="form-control"
                                    placeholder="B4 Text (Max 2 Letters)" maxlength="2">
                            </div>
                        </color-picker>
                    </div>
                </div>

                <div class="d-grid mt-2">
                    <button type="button" class="btn btn-block btn-primary" onclick="sendTo()">Go to Visualizer</button>
                </div>

            </div>
        </div>

        <script type="module">
            import ColorPicker from './components/colorPicker_temp.js';
            const { createApp } = Vue;

            createApp({
                components: {
                    ColorPicker,
                },
                data() {
                    return {
                        schema: {
                            general: {
                                type: '',
                                backgroundColor: '',
                                historyColor: '',
                                showHistory: true,
                            },
                            movement: {
                                stickColor: '',
                                upColor: '',
                                downColor: '',
                                leftColor: '',
                                rightColor: '',
                            },
                            actions: {
                                t1: {
                                    color: '',
                                    text: '',
                                },
                                t2: {
                                    color: '',
                                    text: '',
                                },
                                t3: {
                                    color: '',
                                    text: '',
                                },
                                t4: {
                                    color: '',
                                    text: '',
                                },
                                b1: {
                                    color: '',
                                    text: '',
                                },
                                b2: {
                                    color: '',
                                    text: '',
                                },
                                b3: {
                                    color: '',
                                    text: '',
                                },
                                b4: {
                                    color: '',
                                    text: '',
                                },
                            }
                        }
                    }
                },
                mounted() {
                    console.log(this.schema.general, this.schema.movement, this.schema.actions);
                }
            }).mount('#app');
        </script>

        <script type="text/javascript">
            function byId(id) {
                return document.getElementById(id);
            }

            function changeType(value) {
                console.log(value);
                if (['Hitbox', 'Mixbox'].includes(value)) {
                    document.querySelectorAll('[for-levered]').forEach((e) => e.style.display = 'none');

                    document.querySelector('[for-hitbox]').style.display = (value == 'Hitbox') ? 'flex' : 'none';
                    document.querySelector('[for-mixbox]').style.display = (value == 'Mixbox') ? 'flex' : 'none';
                    document.querySelector('[for-leverless]').style.display = 'flex';

                    byId('upColor').setAttribute('element', (value == 'Hitbox') ? 'hUp' : 'mUp');
                    byId('downColor').setAttribute('element', (value == 'Hitbox') ? 'hDown' : 'mDown');
                    byId('leftColor').setAttribute('element', (value == 'Hitbox') ? 'hLeft' : 'mLeft');
                    byId('rightColor').setAttribute('element', (value == 'Hitbox') ? 'hRight' : 'mRight');
                } else {
                    document.querySelectorAll('[for-leverless], [for-hitbox], [for-mixbox]').forEach((e) => e.style.display = 'none');
                    document.querySelectorAll('[for-levered]').forEach((e) => e.style.display = 'flex');
                }
            }

            byId('inputType').dispatchEvent(new Event('input'));
            byId('showHistory').dispatchEvent(new Event('input'));
            document.querySelectorAll('color-picker').forEach((e) => e.addEventListener('colorchanged', (event) => {
                let element = e.getAttribute('element');
                if (element != '') {
                    if (element == 't1') { // for the display button in input history
                        document.querySelectorAll(`#${element}`).forEach((i) => i.style.backgroundColor = event.detail.color);
                    } else {
                        byId(element).style.backgroundColor = event.detail.color;
                    }
                }
            }));

            document.querySelectorAll('[id$="Text"]').forEach((e) => e.addEventListener('input', () => {
                let id = e.id.substring(0, 2);

                if (id == 't1') { // for the display button in input history
                    document.querySelectorAll(`#${id}`).forEach((i) => i.firstElementChild.innerHTML = e.value);
                } else {
                    byId(id).firstElementChild.innerHTML = e.value;
                }
            }));

            function getParameters() {
                let obj = {
                    general: {
                        type: byId('inputType').value,
                        controllerColor: byId('controllerColor').getAttribute('color'),
                        historyColor: byId('historyColor').getAttribute('color'),
                        showHistory: byId('showHistory').checked,
                    },
                    movement: {
                        stick: byId('stickColor').getAttribute('color'),
                        up: byId('upColor').getAttribute('color'),
                        down: byId('downColor').getAttribute('color'),
                        left: byId('leftColor').getAttribute('color'),
                        right: byId('rightColor').getAttribute('color'),
                    },
                    actions: {
                        t1: {
                            text: byId('t1Text').value,
                            color: byId('t1Color').getAttribute('color'),
                        },
                        t2: {
                            text: byId('t2Text').value,
                            color: byId('t2Color').getAttribute('color'),
                        },
                        t3: {
                            text: byId('t3Text').value,
                            color: byId('t3Color').getAttribute('color'),
                        },
                        t4: {
                            text: byId('t4Text').value,
                            color: byId('t4Color').getAttribute('color'),
                        },
                        b1: {
                            text: byId('b1Text').value,
                            color: byId('b1Color').getAttribute('color'),
                        },
                        b2: {
                            text: byId('b2Text').value,
                            color: byId('b2Color').getAttribute('color'),
                        },
                        b3: {
                            text: byId('b3Text').value,
                            color: byId('b3Color').getAttribute('color'),
                        },
                        b4: {
                            text: byId('b4Text').value,
                            color: byId('b4Color').getAttribute('color'),
                        },
                    },
                };

                return obj;
            }

            function sendTo() {
                let params = btoa(JSON.stringify(getParameters()));
                console.log(params);
            }
        </script>

        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/js/bootstrap.bundle.min.js"
            integrity="sha384-MrcW6ZMFYlzcLA8Nl+NtUVF0sA7MsXsP1UyJoMp4YLEuNSfAP+JcXn/tWtIaxVXM"
            crossorigin="anonymous"></script>

        <!-- <script src="components/colorPicker.js"></script> -->
</body>

</html>